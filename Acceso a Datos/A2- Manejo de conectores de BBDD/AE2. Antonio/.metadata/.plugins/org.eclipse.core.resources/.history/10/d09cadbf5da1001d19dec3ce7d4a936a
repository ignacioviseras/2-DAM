package es.edix.modelo.persistencia;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.ArrayList;

import es.edix.modelo.dao.IntCocheDao;
import es.edix.modelo.entidad.Coche;


public class SqlDaoImpl implements IntCocheDao{
	
	//Primero realizaremos la conexi√≥n a la base de datos:
	
	
	private Connection conexion;
	
	
		public boolean abrirConexion() {
			String cadenaConexion = "jdbc:mysql://localhost:3306/bbdd";
			String user= "root";
			String pass= "";
			
			try {
				conexion=DriverManager.getConnection(cadenaConexion, user, pass);
			}catch (SQLException e) {
				e.printStackTrace();
				return false;
			}
			
			return true;
			
			
		}
		
		public boolean cerrarConexion() {
			
			
			try {
				conexion.close();
			}catch (SQLException e) {
				e.printStackTrace();
				return false;
			}
			
			return true;
			
		}
	
		
		public int newCar(Coche coche) {
			
			String query = "insert into coche (MATRICULA, MARCA,MODELO,COLOR) values (?,?,?,?)";
			
			try {
				PreparedStatement ps = conexion.prepareStatement(query);
				ps.setString(1, coche.getMatricula());
				ps.setString(1, coche.getMarca());
				ps.setString(1, coche.getModelo());
				ps.setString(1, coche.getColor());
				
				int afectados = ps.executeUpdate();
				
				
			}catch (SQLException e) {
				e.printStackTrace();
				return 0;
			}
			return 1;
			
			
			
		}

		public Boolean deleteCar(int id) {
			// TODO Auto-generated method stub
			return null;
		}

		public Coche findById(int id) {
			// TODO Auto-generated method stub
			return null;
		}

		public void listCar() {
			// TODO Auto-generated method stub
			
		}

		public ArrayList<Coche> listOb() {
			// TODO Auto-generated method stub
			return null;
		}

		public int newCar(Coche coche) {
			// TODO Auto-generated method stub
			return 0;
		}

	
	

	
}
